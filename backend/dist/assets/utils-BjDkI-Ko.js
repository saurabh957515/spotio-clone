const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/symbolLayerUtils-C-Q0jDqZ.js","assets/index-IeegpAPg.js","assets/index-D9t-g9sQ.css","assets/LRUCache-B9Ch9jyy.js"])))=>i.map(i=>d[i]);
import{ax as a,ct as h,fi as m,fj as b,fk as d,fl as k,_ as g}from"./index-IeegpAPg.js";import{C as z}from"./cimSymbolUtils-B6qzjiDK.js";import{e as S}from"./LRUCache-B9Ch9jyy.js";import"./utils-DyJ7tXUW.js";new S(1e3);new a([128,128,128]);const x=new a("white");function T(t,n){if(!t)return null;let o=null;return h(t)?o=_(t):m(t)&&(o=t.type==="cim"?z(t):t.color?new a(t.color):null),o?f(o,n):null}function _(t){const n=t.symbolLayers;if(!n)return null;let o=null;return n.forEach(l=>{l.type==="object"&&l.resource?.href||(o=l.type==="water"?l.color:l.material?l.material.color:null)}),o?new a(o):null}function f(t,n){if(n==null||t==null)return t;const o=t.toRgba();return o[3]=o[3]*n,new a(o)}function j(t,n,o){const l=t.symbolLayers;if(!l)return;const i=r=>f(n=n??r??(o!=null?x:null),o);l.forEach(r=>{if(r.type!=="object"||!r.resource?.href||n)if(r.type==="water")r.color=i(r.color);else{const e=r.material!=null?r.material.color:null,u=i(e);r.material==null?r.material=new d({color:u}):r.material.color=u,o!=null&&"outline"in r&&r.outline?.color!=null&&(r.outline.color=f(r.outline.color,o))}})}function v(t,n,o){(n=n??t.color)&&(t.color=f(n,o)),o!=null&&"outline"in t&&t.outline?.color&&(t.outline.color=f(t.outline.color,o))}function U(t,n,o){t&&(n||o!=null)&&(n&&(n=new a(n)),h(t)?j(t,n,o):m(t)&&v(t,n,o))}async function L(t,n){const o=t.symbolLayers;o&&await b(o,async l=>E(l,n))}async function E(t,n){switch(t.type){case"extrude":C(t,n);break;case"icon":case"line":case"text":$(t,n);break;case"path":O(t,n);break;case"object":await R(t,n)}}function $(t,n){const o=p(n);o!=null&&(t.size=o)}function p(t){for(const n of t)if(typeof n=="number")return n;return null}function C(t,n){t.size=typeof n[2]=="number"?n[2]:0}async function R(t,n){const{resourceSize:o,symbolSize:l}=await D(t),i=w(n,o,l);t.width=s(n[0],l[0],o[0],i),t.depth=s(n[1],l[1],o[1],i),t.height=s(n[2],l[2],o[2],i)}function O(t,n){const o=w(n,k,[t.width,void 0,t.height]);t.width=s(n[0],t.width,1,o),t.height=s(n[2],t.height,1,o)}function w(t,n,o){for(let l=0;l<3;l++){const i=t[l];switch(i){case"symbol-value":{const r=o[l];return r!=null?r/n[l]:1}case"proportional":break;default:if(i&&n[l])return i/n[l]}}return 1}async function D(t){const{computeObjectLayerResourceSize:n}=await g(()=>import("./symbolLayerUtils-C-Q0jDqZ.js"),__vite__mapDeps([0,1,2,3])),o=await n(t,10),{width:l,height:i,depth:r}=t,e=[l,r,i];let u=1;for(let c=0;c<3;c++){const y=e[c];if(y!=null){u=y/o[c];break}}for(let c=0;c<3;c++)e[c]==null&&(e[c]=o[c]*u);return{resourceSize:o,symbolSize:e}}function s(t,n,o,l){switch(t){case"proportional":return o*l;case"symbol-value":return n??o;default:return t}}function I(t,n){const o=p(n);if(o!=null)switch(t.type){case"simple-marker":t.size=o;break;case"picture-marker":{const l=t.width/t.height;l>1?(t.width=o,t.height=o*l):(t.width=o*l,t.height=o);break}case"simple-line":t.width=o;break;case"text":t.font.size=o}}async function V(t,n){if(t&&n)return h(t)?L(t,n):void(m(t)&&I(t,n))}function q(t,n,o){if(t&&n!=null)if(h(t)){const l=t.symbolLayers;l&&l.forEach(i=>{if(i.type==="object")switch(o){case"tilt":i.tilt=(i.tilt??0)+n;break;case"roll":i.roll=(i.roll??0)+n;break;default:i.heading=(i.heading??0)+n}i.type==="icon"&&(i.angle+=n)})}else m(t)&&(t.type!=="simple-marker"&&t.type!=="picture-marker"&&t.type!=="text"||(t.angle+=n))}async function B(t,n){return await t.fetchSymbol(n)||t.fetchCIMSymbol(n)}export{q as D,B as N,V as R,U as g,T as h};
